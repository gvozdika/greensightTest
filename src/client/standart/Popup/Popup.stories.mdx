import { Meta, Story, Canvas, ArgsTable } from '@storybook/addon-docs/blocks';
import { text, boolean } from '@storybook/addon-knobs';
import { useState } from 'react';
import { Button } from '@greensight/gds';
import centeredDecorator from '@decorators/centeredDecorator';
import Popup from '.';

<Meta title="Standart / Popup" component={Popup} decorators={[centeredDecorator]} />

# Popup

<Story
    name="Controls"
    args={{
        title: '–ó–∞–≥–æ–ª–æ–≤–æ–∫',
        isCloseButton: true,
        isFullscreen: false,
    }}
    argTypes={{
        title: { control: 'text' },
        isCloseButton: { control: 'boolean' },
        isFullscreen: { control: 'boolean' },
    }}
>
    {args => {
        const Example = () => {
            const [isPopupOpen, setIsPopupOpen] = useState(false);
            return (
                <div>
                    <Button onClick={() => setIsPopupOpen(true)}>–û—Ç–∫—Ä—ã—Ç—å –ø–æ–ø–∞–ø</Button>
                    <Popup isOpen={isPopupOpen} onRequestClose={() => setIsPopupOpen(false)} {...args}>
                        <p>–ö–æ–Ω—Ç–µ–Ω—Ç</p>
                    </Popup>
                </div>
            );
        };
        return <Example />;
    }}
</Story>

–ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Å—Ç—Ä–æ—è—Ç—Å—è –≤—Å–µ –ø–æ–ø–∞–ø—ã –ø—Ä–æ–µ–∫—Ç–∞. –í–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –¥–≤–∏–∂–æ–∫ –∏ –±–∞–∑–æ–≤—É—é —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—é.

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–ª–∞–≥–∏–Ω: [react-modal](http://reactcommunity.org/react-modal/)

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: [WAI-ARIA](https://www.w3.org/TR/wai-aria-practices/#dialog_modal)

–ü–æ–ø–∞–ø—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–∫—Å–µ—Å—Å–∞–±–∏–ª—å–Ω—ã: —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–µ—Ä–µ–Ω–æ—Å —Ñ–æ–∫—É—Å–∞ –≤–Ω—É—Ç—Ä—å –ø–æ–ø–∞–ø–∞ –∏ –æ–±—Ä–∞—Ç–Ω–æ, focus trapping –≤ —Ä–∞–º–∫–∞—Ö –ø–æ–ø–∞–ø–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ Esc –∏ –∫–ª–∏–∫–∞ –ø–æ –æ–≤–µ—Ä–ª–µ—é.

–ü–æ–ø–∞–ø –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞. –ü—Ä–∏ —ç—Ç–æ–º –æ–Ω –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω –Ω–∞ —É—Ä–æ–≤–µ–Ω—å body —á–µ—Ä–µ–∑ **Portals API**. –ü–æ—Ä—Ç–∞–ª —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–º–µ—Ç–∫–µ –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ, —É—Å–ª–æ–≤–Ω–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ.

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç **Popup** –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ä–∞–∑–º–µ—Ç–∫—É –±–µ–∑ —É—Å–ª–æ–≤–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏ –æ–Ω –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ–ø—Å–∞ **isOpen**, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º–æ–≥–æ —á–µ—Ä–µ–∑ state.

–î–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–∫—Ä–æ–ª–ª–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω –ø–ª–∞–≥–∏–Ω [body-scroll-lock](https://github.com/willmcpo/body-scroll-lock).

‚òùüèø –ß—Ç–æ–±—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–∫—Ä–æ–ª–ª –ª–æ–∫–∞ –Ω–∞ –¥–µ–≤–∞–π—Å–∞—Ö –æ—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç–æ—Ä–∏—Å scroll lock –≤ —Ä–µ–∂–∏–º–µ **Canvas** –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º. –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —Ç.–∫. –ø–ª–∞–≥–∏–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏ —Ñ—Ä–µ–π–º–∞ (–∞ –≤—Å–µ —Å—Ç–æ—Ä–∏—Å—ã –≤—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –Ω–∏—Ö).

–ü–æ–ø–∞–ø –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ–ø–∞–ø–∞ - —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏. **Popup** - —ç—Ç–æ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –æ–±—ë—Ä—Ç–∫–∞, —Ä–µ–∞–ª–∏–∑—É—é—â–∞—è –ª–æ–≥–∏–∫—É –ø–æ–ø–∞–ø–æ–≤ –∏ –Ω–µ –Ω–µ—Å—É—â–∞—è –∑–∞ —Å–æ–±–æ–π –Ω–∏–∫–∞–∫–æ–π —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –í –∫–∞—á–µ—Å—Ç–≤–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ª—é–±–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–ª–∏ –≥—Ä—É–ø–ø–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –≤ –µ–≥–æ –≥–∏–±–∫–æ—Å—Ç–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å code splitting –¥–ª—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ. –≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä –µ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è, —Ç.–∫. –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç –ø–æ–ø–∞–ø –ø—Ä–∏ –ø–µ—Ä–≤–∏—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ, –∞ –ø–æ—è–≤–ª–µ–Ω–∏–µ –µ–≥–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞.

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –î–ª—è –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞ —Ñ–æ–∫—É—Å–∞ –∏ AT –ø–æ–ø–∞–ø—ã –≤—ã–Ω–æ—Å—è—Ç—Å—è —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç–∞–ª—ã –Ω–∞ —É—Ä–æ–≤–µ–Ω—å body –≤–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (root). –≠—Ç—É —Ä–∞–±–æ—Ç—É –¥–µ–ª–∞–µ—Ç **react-modal** –∑–∞ –Ω–∞—Å: –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É —Ñ–æ–∫—É—Å–∞ –Ω–∞ –ø–æ–ø–∞–ø –∏ –æ–±—Ä–∞—Ç–Ω–æ, –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç focus trapping –≤ —Ä–∞–º–∫–∞—Ö –ø–æ–ø–∞–ø–∞ –∏ —Å—Ç–∞–≤–∏—Ç aria-hidden –Ω–∞ root.
1. –ö–ª–∞—Å—Å popup –∏–º–µ–µ—Ç —Å–∞–º –ø–æ—Ä—Ç–∞–ª, —Ç.–∫. –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ø–∞–ø–∞ –ø–æ—Ä—Ç–∞–ª —Å–≤–æ–π. –¢–∞–∫ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –ø–æ–ø–∞–ø–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤—Ç–æ—Ä–æ–π –ø–æ—Ä—Ç–∞–ª —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º –≤–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –ø–æ–ø–∞–ø–∞, –∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø–æ–ø–∞–ø –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω–∞ –º–µ—Å—Ç–µ –≤ —Å–≤–æ—ë–º –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ä—Ç–∞–ª–µ.
1. –í–Ω—É—Ç—Ä–∏ –ø–æ–ø–∞–ø–∞ 2 –æ–±—ë—Ä—Ç–∫–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ **react-modal**: **overlay** –∏ **content**. Overlay - —Ä–∞—Å—Ç—è–Ω—É—Ç –Ω–∞ –≤—å—é–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ position: fixed, content - –ª–µ–∂–∏—Ç –≤–Ω—É—Ç—Ä–∏ –æ–≤–µ—Ä–ª–µ—è –∏ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –ª—é–±—É—é –≤—ã—Å–æ—Ç—É. –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –≤—ã—Å–æ—Ç—ã –≤—å—é–ø–æ—Ä—Ç–∞ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–∫—Ä–æ–ª–ª.
1. –ü—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ø–∞–ø–æ–≤ —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—É popup -> overlay -> content —Å–∫—Ä–æ–ª–ª –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–∫—Ä–æ–ª–ª–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ–≤–µ—Ä–ª–µ—è –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—ë—Ä—Ç–∫–∞ popup -> overlay -> wrapper -> content. –¢.–∫. –º—ã –Ω–µ –º–æ–∂–µ–º –≤–ª–∏—è—Ç—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É **react-modal**, —Ç–æ content –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω –≤–æ–∫—Ä—É–≥ children, –∞ –≤–º–µ—Å—Ç–æ contentClasses (react-modal className prop) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–ª–∞—Å—Å—ã wrapper. –¢–∞–∫ —á—Ç–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ–º–æ (–Ω–æ —Å–º—ã—Å–ª–∞ –≤ —ç—Ç–æ–º –º–∞–ª–æ).
1. –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ flex. –ü—Ä–∏ —ç—Ç–æ–º —á—Ç–æ–±—ã –≤—ã—Å–æ–∫–∏–µ –ø–æ–ø–∞–ø—ã –Ω–µ —Ä–µ–∑–∞–ª–∏—Å—å –ø–æ –≤—å—é–ø–æ—Ä—Ç—É –∫–æ–Ω—Ç–µ–Ω—Ç—É –¥–æ–±–∞–≤–ª–µ–Ω max-height: '100%'. –≠—Ç–æ –∂–µ –ø—Ä–∞–≤–∏–ª–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å overflow.

## Props

<ArgsTable story="Controls" />

## Use cases

### Basic

<Canvas>
    <Story name="Basic">
        {() => {
            const Example = () => {
                const [isPopupOpen, setIsPopupOpen] = useState(false);
                return (
                    <div>
                        <Button onClick={() => setIsPopupOpen(true)}>–û—Ç–∫—Ä—ã—Ç—å –ø–æ–ø–∞–ø</Button>
                        <Popup isOpen={isPopupOpen} onRequestClose={() => setIsPopupOpen(false)} title="–ó–∞–≥–æ–ª–æ–≤–æ–∫">
                            <p>–ö–æ–Ω—Ç–µ–Ω—Ç</p>
                        </Popup>
                    </div>
                );
            };
            return <Example />;
        }}
    </Story>
</Canvas>

### Visually hidden title

–ï—Å–ª–∏ —É –ø–æ–ø–∞–ø–∞ –Ω–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞, —Ç–æ –≤–º–µ—Å—Ç–æ **title** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **contentLabel** –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è —Å–∫—Ä—ã—Ç–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è —Å–∫—Ä–∏–Ω—Ä–∏–¥–µ—Ä–æ–≤.

<Canvas>
    <Story name="Visually hidden title">
        {() => {
            const Example = () => {
                const [isPopupOpen, setIsPopupOpen] = useState(false);
                return (
                    <div>
                        <Button onClick={() => setIsPopupOpen(true)}>–û—Ç–∫—Ä—ã—Ç—å –ø–æ–ø–∞–ø</Button>
                        <Popup
                            isOpen={isPopupOpen}
                            onRequestClose={() => setIsPopupOpen(false)}
                            contentLabel="–ó–∞–≥–æ–ª–æ–≤–æ–∫"
                        >
                            <p>–ö–æ–Ω—Ç–µ–Ω—Ç</p>
                        </Popup>
                    </div>
                );
            };
            return <Example />;
        }}
    </Story>
</Canvas>

### Inner popup

–í–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–ø–∞–ø—ã —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è.

<Canvas>
    <Story name="Inner popup">
        {() => {
            const Example = () => {
                const [isPopupOpen, setIsPopupOpen] = useState(false);
                const [isInnerPopupOpen, setIsInnerPopupOpen] = useState(false);
                return (
                    <div>
                        <Button onClick={() => setIsPopupOpen(true)}>–û—Ç–∫—Ä—ã—Ç—å –ø–æ–ø–∞–ø</Button>
                        <Popup
                            isOpen={isPopupOpen}
                            onRequestClose={() => setIsPopupOpen(false)}
                            id="outer-popup"
                            title="–í–Ω–µ—à–Ω–∏–π –ø–æ–ø–∞–ø"
                        >
                            <p>–ö–æ–Ω—Ç–µ–Ω—Ç</p>
                            <br />
                            <Button onClick={() => setIsInnerPopupOpen(true)}>Open inner popup</Button>
                            <Popup
                                isOpen={isInnerPopupOpen}
                                onRequestClose={() => setIsInnerPopupOpen(false)}
                                id="inner-popup"
                                title="–í–ª–æ–∂–µ–Ω–Ω—ã–π –ø–æ–ø–∞–ø"
                            >
                                <p>–ö–æ–Ω—Ç–µ–Ω—Ç</p>
                            </Popup>
                        </Popup>
                    </div>
                );
            };
            return <Example />;
        }}
    </Story>
</Canvas>
